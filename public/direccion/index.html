<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seleccionar Dirección | La Desesperanza</title>

    <!-- CSS de la aplicación -->
    <link rel="stylesheet" href="../assets/css/clientBase.css">
    <link rel="stylesheet" href="../assets/css/clientHeader.css">
    <link rel="stylesheet" href="../assets/css/addressSelector.css">

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin=""/>

    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>

<header class="client-header">
    <a href="/" class="header-logo">La Desesperanza</a>
    <nav class="client-nav">
        <a href="/">Inicio</a>
        <a href="/tienda/">Tienda</a>
        <a href="/cliente/">Mi Cuenta</a>
        <a href="/cliente/carrito/" class="cart-icon" id="cart-link">
            <svg class="cart-icon-svg" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 10.5V6a3.75 3.75 0 1 0-7.5 0v4.5m11.356-1.993 1.263 12c.07.656-.414 1.243-1.067 1.243H4.51c-.653 0-1.137-.587-1.067-1.243L4.707 8.507c.072-.656.596-1.144 1.253-1.144h.211a.75.75 0 0 1 .75.75v.003a.75.75 0 0 1-.75.75H5.961l-.91 8.107h13.916l-.91-8.107h-.211a.75.75 0 0 1-.75-.75v-.003a.75.75 0 0 1 .75.75h.211c.657 0 1.18.487 1.253 1.144Z" />
            </svg>
            <span class="cart-badge" id="cart-badge">0</span>
        </a>
        <div id="client-theme-switcher" class="theme-switcher" title="Cambiar Tema">
            <div class="theme-icon"></div>
        </div>
    </nav>
</header>

<main class="address-container">
    <div class="address-header">
        <h1>Selecciona tu Dirección de Entrega</h1>
        <p>Haz clic en el mapa para marcar tu ubicación exacta</p>
    </div>

    <div class="address-content">
        <!-- Mapa de Leaflet -->
        <div class="map-section">
            <div id="map" class="map-container"></div>
            <div class="map-controls">
                <button id="btn-my-location" class="map-control-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                    Usar mi ubicación
                </button>
                <button id="btn-search" class="map-control-btn secondary">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="m21 21-4.35-4.35"></path>
                    </svg>
                    Buscar lugar
                </button>
            </div>
        </div>

        <!-- Formulario de dirección -->
        <div class="form-section">
            <form id="address-form">
                <div class="form-group">
                    <label for="alias">Nombre de la dirección *</label>
                    <input type="text" id="alias" placeholder="Casa, Oficina, etc." required>
                </div>

                <div class="form-group">
                    <label for="calle">Calle y número *</label>
                    <input type="text" id="calle" placeholder="Av. Siempre Viva 742" required>
                </div>

                <div class="form-group-row">
                    <div class="form-group">
                        <label for="colonia">Colonia *</label>
                        <input type="text" id="colonia" placeholder="Centro" required>
                    </div>
                    <div class="form-group">
                        <label for="codigo_postal">Código Postal *</label>
                        <input type="text" id="codigo_postal" placeholder="12345" maxlength="5" required>
                    </div>
                </div>

                <div class="form-group-row">
                    <div class="form-group">
                        <label for="ciudad">Ciudad *</label>
                        <input type="text" id="ciudad" placeholder="Ciudad de México" required>
                    </div>
                    <div class="form-group">
                        <label for="estado">Estado *</label>
                        <input type="text" id="estado" placeholder="CDMX" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="referencias">Referencias (opcional)</label>
                    <textarea id="referencias" placeholder="Entre qué calles, edificio, piso, etc." rows="3"></textarea>
                </div>

                <div class="coordinates-display">
                    <p><strong>Coordenadas:</strong></p>
                    <p>Latitud: <span id="display-lat">--</span></p>
                    <p>Longitud: <span id="display-lng">--</span></p>
                </div>

                <input type="hidden" id="latitud" name="latitud">
                <input type="hidden" id="longitud" name="longitud">

                <div class="form-actions">
                    <button type="button" id="btn-cancel" class="btn-secondary">Cancelar</button>
                    <button type="submit" id="btn-save" class="btn-primary">Guardar Dirección</button>
                </div>
            </form>

            <div id="saved-addresses" class="saved-addresses-section">
                <h3>Direcciones Guardadas</h3>
                <div id="addresses-list" class="addresses-list">
                    <!-- Las direcciones se cargarán aquí dinámicamente -->
                </div>
            </div>
        </div>
    </div>
</main>

<footer class="client-footer-detailed">
    <div class="footer-grid">
        <div class="footer-column">
            <h4>La Desesperanza</h4>
            <p>Horneando tradición y sabor rústico desde 2025.</p>
        </div>
        <div class="footer-column">
            <h4>Navegación</h4>
            <a href="/">Inicio</a>
            <a href="/tienda/">Tienda</a>
            <a href="/cliente/">Mi Cuenta</a>
        </div>
        <div class="footer-column">
            <h4>Contacto</h4>
            <p>Email: <a href="mailto:soporte@desesperanza.bullnodes.com">soporte@desesperanza.bullnodes.com</a></p>
            <p>Teléfono: 55 6969 6969</p>
        </div>
    </div>
    <div class="footer-bottom">
        <p>&copy; La Desesperanza 2025. Todos los derechos reservados.</p>
    </div>
</footer>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
        crossorigin=""></script>

<!-- Scripts de la aplicación -->
<script src="../assets/js/api.js"></script>
<script src="../assets/js/clientNav.js"></script>
<script src="../assets/js/clientThemeChanger.js"></script>
<script src="js/addressSelector.js"></script>
</body>
</html>